#!/usr/bin/env python

import infoblox_client

infoblox_api = {
  'host': '{{ infoblox_host }}',
  'username': '{{ infoblox_username }}',
  'password': '{{ infoblox_password }}'
}

name='instance-{{ deployment_name }}-{{ role_name }}'
ip='{{ ansible_facts["ansible_default_ipv4"]["address"] }}'
ttl=600

infoblox_client.objects.HostRecord.update(
  infoblox_client.connector.Connector(infoblox_api),
  name=name, ip=ip, ttl=ttl)
